(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[356],{2321:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var a=s(5155),r=s(2115),l=s(7969),o=s(4807),n=s(2712);function i(){let[e,t]=(0,r.useState)([]),[s,i]=(0,r.useState)(!1),[c,d]=(0,r.useState)(""),[x,m]=(0,r.useState)(1),[u]=(0,r.useState)(12),[h,p]=(0,r.useState)(!1),[g,b]=(0,r.useState)({dia:"Lun",hora:"",nombre:"Yoga"});(0,r.useEffect)(()=>{y()},[]);let y=async()=>{try{let e=await (0,n.q)("/api/clases",{},{route:"/api/clases",operation:"load_clases"}),s=await e.json();Array.isArray(s)?t(s):t([])}catch(e){console.error("Error loading clases:",e),alert(e.message||"Error al cargar clases"),t([])}},f=async()=>{if(confirm("\xbfInicializar las clases semanales fijas? Esto solo funcionar\xe1 si no hay clases existentes.")){i(!0);try{await (0,n.q)("/api/clases",{method:"POST",headers:{"Content-Type":"application/json"}},{route:"/api/clases",operation:"initialize_clases"}),alert("Clases inicializadas correctamente"),y()}catch(e){alert(e.message||"Error al inicializar clases")}finally{i(!1)}}},v=async e=>{if(e.preventDefault(),!g.dia||!g.hora||!g.nombre)return void alert("Por favor completa todos los campos");if(!/^([0-1][0-9]|2[0-3]):[0-5][0-9]$/.test(g.hora))return void alert("Formato de hora inv\xe1lido. Use HH:MM (ej: 17:30)");i(!0);try{await (0,n.q)("/api/clases",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)},{route:"/api/clases",operation:"create_clase"}),p(!1),b({dia:"Lun",hora:"",nombre:"Yoga"}),y()}catch(e){alert(e.message||"Error al crear clase")}finally{i(!1)}},j=async e=>{if(confirm("\xbfEst\xe1s seguro de eliminar esta clase? Esto tambi\xe9n eliminar\xe1 todas las reservas asociadas."))try{await (0,n.q)("/api/clases?id=".concat(e),{method:"DELETE"},{route:"/api/clases",operation:"delete_clase"}),y()}catch(e){alert(e.message||"Error al eliminar")}},w=e=>({Lun:"Lunes",Mar:"Martes",Jue:"Jueves",Sab:"S\xe1bado"})[e]||e,N=e.filter(e=>{if(!c)return!0;let t=c.toLowerCase();return w(e.dia).toLowerCase().includes(t)||e.dia.toLowerCase().includes(t)||e.hora.toLowerCase().includes(t)||e.nombre.toLowerCase().includes(t)}),E=Math.ceil(N.length/u),C=(x-1)*u,L=C+u,S=N.slice(C,L);return(0,r.useEffect)(()=>{m(1)},[c]),(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 overflow-x-hidden",children:[(0,a.jsx)(l.A,{}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 lg:px-8 py-4 sm:py-6 lg:py-8",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 sm:gap-0 mb-4 sm:mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold text-gray-900",children:"Clases Semanales"}),(0,a.jsx)("p",{className:"text-gray-600 mt-1 sm:mt-2 text-sm sm:text-base",children:"Horarios fijos que se repiten todas las semanas"})]}),(0,a.jsxs)("div",{className:"flex gap-2 w-full sm:w-auto",children:[0===e.length&&(0,a.jsx)("button",{onClick:f,disabled:s,className:"bg-purple-600 text-white px-3 sm:px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 text-sm sm:text-base flex-1 sm:flex-none",children:s?"Inicializando...":"Inicializar Clases"}),(0,a.jsx)("button",{onClick:()=>{p(!0),b({dia:"Lun",hora:"",nombre:"Yoga"})},className:"bg-purple-600 text-white px-3 sm:px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors text-sm sm:text-base flex-1 sm:flex-none",children:"+ Nueva Clase"})]})]}),h&&(0,a.jsxs)("div",{className:"bg-white p-4 sm:p-6 rounded-lg shadow-md mb-4 sm:mb-6",children:[(0,a.jsx)("h2",{className:"text-xl sm:text-2xl font-semibold mb-4 text-gray-900",children:"Nueva Clase"}),(0,a.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"D\xeda *"}),(0,a.jsxs)("select",{value:g.dia,onChange:e=>b({...g,dia:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-gray-900",required:!0,children:[(0,a.jsx)("option",{value:"Lun",children:"Lunes"}),(0,a.jsx)("option",{value:"Mar",children:"Martes"}),(0,a.jsx)("option",{value:"Jue",children:"Jueves"}),(0,a.jsx)("option",{value:"Sab",children:"S\xe1bado"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hora * (HH:MM)"}),(0,a.jsx)("input",{type:"text",value:g.hora,onChange:e=>b({...g,hora:e.target.value}),placeholder:"17:30",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-gray-900 placeholder:text-gray-500",required:!0,pattern:"^([0-1][0-9]|2[0-3]):[0-5][0-9]$"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre *"}),(0,a.jsx)("input",{type:"text",value:g.nombre,onChange:e=>b({...g,nombre:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-gray-900 placeholder:text-gray-500",required:!0})]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,a.jsx)("button",{type:"submit",disabled:s,className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 disabled:opacity-50 text-sm sm:text-base w-full sm:w-auto",children:s?"Guardando...":"Guardar"}),(0,a.jsx)("button",{type:"button",onClick:()=>{p(!1),b({dia:"Lun",hora:"",nombre:"Yoga"})},className:"bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 text-sm sm:text-base w-full sm:w-auto",children:"Cancelar"})]})]})]}),e.length>0&&(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"text",placeholder:"Buscar por d\xeda, hora o nombre...",value:c,onChange:e=>d(e.target.value),className:"w-full px-4 py-2 pl-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-gray-900 placeholder:text-gray-500"}),(0,a.jsx)("svg",{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),c&&(0,a.jsx)("button",{onClick:()=>d(""),className:"absolute right-3 top-2.5 text-gray-400 hover:text-gray-600",children:"âœ•"})]}),c&&(0,a.jsxs)("p",{className:"mt-2 text-sm text-gray-600",children:["Mostrando ",N.length," de ",e.length," clases"]})]}),0===e.length?(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-8 text-center",children:[(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"No hay clases inicializadas."}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:"Las clases semanales fijas son:"}),(0,a.jsxs)("div",{className:"text-left max-w-md mx-auto space-y-2 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Lunes:"})," 17:30, 19:00"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Martes:"})," 10:00, 17:30, 19:00"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Jueves:"})," 10:00, 16:00, 17:30, 19:00"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"S\xe1bado:"})," 09:30, 11:00"]})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:(0,a.jsx)(o.A,{className:"mx-0",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 sm:px-6 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"D\xeda"}),(0,a.jsx)("th",{className:"px-4 sm:px-6 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Hora"}),(0,a.jsx)("th",{className:"px-4 sm:px-6 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Nombre"}),(0,a.jsx)("th",{className:"px-4 sm:px-6 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Acciones"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:S.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-4 sm:px-6 py-2 whitespace-nowrap text-sm font-medium text-gray-900",children:w(e.dia)}),(0,a.jsx)("td",{className:"px-4 sm:px-6 py-2 whitespace-nowrap text-sm text-gray-900",children:e.hora}),(0,a.jsx)("td",{className:"px-4 sm:px-6 py-2 whitespace-nowrap text-sm text-gray-900",children:e.nombre}),(0,a.jsx)("td",{className:"px-4 sm:px-6 py-2 whitespace-nowrap text-sm font-medium",children:(0,a.jsx)("button",{onClick:()=>j(e.id),className:"px-3 py-2 sm:px-0 sm:py-0 rounded-md sm:rounded-none bg-red-50 sm:bg-transparent text-red-600 hover:text-red-900 hover:bg-red-100 sm:hover:bg-transparent text-sm font-medium transition-colors",children:"Eliminar"})})]},e.id))})]})})}),E>1&&(0,a.jsxs)("div",{className:"bg-white px-4 py-3 border-t border-gray-200 flex flex-col sm:flex-row items-center justify-between gap-4 mt-4 rounded-lg shadow-md",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-700",children:["Mostrando ",C+1," a ",Math.min(L,N.length)," de ",N.length," clases"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>m(e=>Math.max(1,e-1)),disabled:1===x,className:"px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Anterior"}),(0,a.jsx)("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,E)},(e,t)=>{let s;return s=E<=5||x<=3?t+1:x>=E-2?E-4+t:x-2+t,(0,a.jsx)("button",{onClick:()=>m(s),className:"px-3 py-2 text-sm font-medium rounded-lg ".concat(x===s?"bg-purple-600 text-white":"text-gray-700 bg-white border border-gray-300 hover:bg-gray-50"),children:s},s)})}),(0,a.jsx)("button",{onClick:()=>m(e=>Math.min(E,e+1)),disabled:x===E,className:"px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Siguiente"})]})]})]})]})]})}},2712:(e,t,s)=>{"use strict";async function a(e,t){let s="Error desconocido",a=null;try{let t=e.headers.get("content-type");s=t&&t.includes("application/json")?(null==(a=await e.json())?void 0:a.error)||s:await e.text()||"HTTP ".concat(e.status,": ").concat(e.statusText)}catch(t){s="Error al procesar respuesta: ".concat(e.status," ").concat(e.statusText)}console.error("=== API ERROR ===",{route:t.route,operation:t.operation,status:e.status,statusText:e.statusText,errorDetails:a,timestamp:new Date().toISOString()});let r=s;if(a){var l,o,n;((null==(l=a.details)?void 0:l.includes("Database"))||(null==(o=a.details)?void 0:o.includes("D1"))||(null==(n=a.details)?void 0:n.includes("binding")))&&(r="Error de base de datos: "+s,"cloudflare"===a.environment&&(r+="\n\nVerifica la configuraci\xf3n de D1 en Cloudflare Pages.")),a.details&&a.details!==s&&(console.error("Error details:",a.details),"localhost"===window.location.hostname&&(r+="\n\nDetalles: ".concat(a.details))),a.debug&&console.error("Debug info:",a.debug)}return r}async function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;try{let r=await fetch(e,t);if(!r.ok){let e=await a(r,s);throw Error(e)}return r}catch(e){if("TypeError"===e.name&&e.message.includes("fetch"))throw console.error("=== NETWORK ERROR ===",{route:s.route,operation:s.operation,error:e.message,timestamp:new Date().toISOString()}),Error("Error de conexi\xf3n. Verifica tu conexi\xf3n a internet o si el servidor est\xe1 disponible.");throw e}}s.d(t,{q:()=>r})},4580:(e,t,s)=>{Promise.resolve().then(s.bind(s,2321))},4807:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});var a=s(5155),r=s(2115);function l(e){let{children:t,className:s=""}=e,l=(0,r.useRef)(null);return(0,r.useEffect)(()=>{let e=l.current;if(!e)return;let t=0,s=0,a=null,r=e=>{let r=e.touches[0];t=r.clientX,s=r.clientY,a=null},o=r=>{if(!e||0===r.touches.length)return;let l=r.touches[0],o=l.clientX-t,n=l.clientY-s;if(null===a&&(Math.abs(o)>5||Math.abs(n)>5)&&(a=Math.abs(o)>Math.abs(n)?"horizontal":"vertical"),"horizontal"===a){let t=e.scrollLeft,s=e.scrollWidth,a=e.clientWidth;o<0&&t>0||o>0&&t<s-a-1?r.stopPropagation():(r.preventDefault(),r.stopPropagation())}},n=()=>{a=null};return e.addEventListener("touchstart",r,{passive:!0,capture:!0}),e.addEventListener("touchmove",o,{passive:!1,capture:!0}),e.addEventListener("touchend",n,{passive:!0,capture:!0}),()=>{e.removeEventListener("touchstart",r,{capture:!0}),e.removeEventListener("touchmove",o,{capture:!0}),e.removeEventListener("touchend",n,{capture:!0})}},[]),(0,a.jsx)("div",{ref:l,className:"scroll-horizontal ".concat(s),children:t})}},7969:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var a=s(5155),r=s(6874),l=s.n(r),o=s(5695);function n(){let e=(0,o.useRouter)(),t=async()=>{await fetch("/api/auth/logout",{method:"POST"}),e.push("/login"),e.refresh()};return(0,a.jsx)("nav",{className:"bg-purple-600 text-white shadow-lg sticky top-0 z-50",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center h-14 sm:h-16",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 sm:space-x-4 lg:space-x-8 overflow-x-auto",children:[(0,a.jsx)(l(),{href:"/",className:"text-lg sm:text-xl font-bold whitespace-nowrap",children:"Clases Bot"}),(0,a.jsx)(l(),{href:"/usuarios",className:"hover:text-purple-200 transition-colors text-sm sm:text-base whitespace-nowrap",children:"Alumnos"}),(0,a.jsx)(l(),{href:"/clases",className:"hover:text-purple-200 transition-colors text-sm sm:text-base whitespace-nowrap",children:"Clases"}),(0,a.jsx)(l(),{href:"/calendario",className:"hover:text-purple-200 transition-colors text-sm sm:text-base whitespace-nowrap",children:"Calendario"})]}),(0,a.jsx)("button",{onClick:t,className:"hover:text-purple-200 transition-colors text-xs sm:text-sm whitespace-nowrap px-2 sm:px-0",children:"Salir"})]})})})}}},e=>{e.O(0,[244,441,964,358],()=>e(e.s=4580)),_N_E=e.O()}]);