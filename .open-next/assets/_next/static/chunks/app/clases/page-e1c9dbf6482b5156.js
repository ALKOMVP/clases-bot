(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[356],{2321:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>o});var t=a(5155),r=a(2115),l=a(7969),i=a(2712);function o(){let[e,s]=(0,r.useState)([]),[a,o]=(0,r.useState)(!1),[n,c]=(0,r.useState)(""),[d,x]=(0,r.useState)(!1),[u,h]=(0,r.useState)({dia:"Lun",hora:"",nombre:"Yoga"});(0,r.useEffect)(()=>{m()},[]);let m=async()=>{try{let e=await (0,i.q)("/api/clases",{},{route:"/api/clases",operation:"load_clases"}),a=await e.json();Array.isArray(a)?s(a):s([])}catch(e){console.error("Error loading clases:",e),alert(e.message||"Error al cargar clases"),s([])}},p=async()=>{if(confirm("\xbfInicializar las clases semanales fijas? Esto solo funcionar\xe1 si no hay clases existentes.")){o(!0);try{await (0,i.q)("/api/clases",{method:"POST",headers:{"Content-Type":"application/json"}},{route:"/api/clases",operation:"initialize_clases"}),alert("Clases inicializadas correctamente"),m()}catch(e){alert(e.message||"Error al inicializar clases")}finally{o(!1)}}},g=async e=>{if(e.preventDefault(),!u.dia||!u.hora||!u.nombre)return void alert("Por favor completa todos los campos");if(!/^([0-1][0-9]|2[0-3]):[0-5][0-9]$/.test(u.hora))return void alert("Formato de hora inv\xe1lido. Use HH:MM (ej: 17:30)");o(!0);try{await (0,i.q)("/api/clases",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)},{route:"/api/clases",operation:"create_clase"}),x(!1),h({dia:"Lun",hora:"",nombre:"Yoga"}),m()}catch(e){alert(e.message||"Error al crear clase")}finally{o(!1)}},b=async e=>{if(confirm("\xbfEst\xe1s seguro de eliminar esta clase? Esto tambi\xe9n eliminar\xe1 todas las reservas asociadas."))try{await (0,i.q)("/api/clases?id=".concat(e),{method:"DELETE"},{route:"/api/clases",operation:"delete_clase"}),m()}catch(e){alert(e.message||"Error al eliminar")}},j=e=>({Lun:"Lunes",Mar:"Martes",Jue:"Jueves",Sab:"S\xe1bado"})[e]||e,y=e.filter(e=>{if(!n)return!0;let s=n.toLowerCase();return j(e.dia).toLowerCase().includes(s)||e.dia.toLowerCase().includes(s)||e.hora.toLowerCase().includes(s)||e.nombre.toLowerCase().includes(s)});return(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)(l.A,{}),(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-4xl font-bold text-gray-900",children:"Clases Semanales"}),(0,t.jsx)("p",{className:"text-gray-600 mt-2",children:"Horarios fijos que se repiten todas las semanas"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[0===e.length&&(0,t.jsx)("button",{onClick:p,disabled:a,className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50",children:a?"Inicializando...":"Inicializar Clases"}),(0,t.jsx)("button",{onClick:()=>{x(!0),h({dia:"Lun",hora:"",nombre:"Yoga"})},className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors",children:"+ Nueva Clase"})]})]}),d&&(0,t.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md mb-6",children:[(0,t.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"Nueva Clase"}),(0,t.jsxs)("form",{onSubmit:g,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"D\xeda *"}),(0,t.jsxs)("select",{value:u.dia,onChange:e=>h({...u,dia:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0,children:[(0,t.jsx)("option",{value:"Lun",children:"Lunes"}),(0,t.jsx)("option",{value:"Mar",children:"Martes"}),(0,t.jsx)("option",{value:"Jue",children:"Jueves"}),(0,t.jsx)("option",{value:"Sab",children:"S\xe1bado"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hora * (HH:MM)"}),(0,t.jsx)("input",{type:"text",value:u.hora,onChange:e=>h({...u,hora:e.target.value}),placeholder:"17:30",className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0,pattern:"^([0-1][0-9]|2[0-3]):[0-5][0-9]$"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre *"}),(0,t.jsx)("input",{type:"text",value:u.nombre,onChange:e=>h({...u,nombre:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",required:!0})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{type:"submit",disabled:a,className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 disabled:opacity-50",children:a?"Guardando...":"Guardar"}),(0,t.jsx)("button",{type:"button",onClick:()=>{x(!1),h({dia:"Lun",hora:"",nombre:"Yoga"})},className:"bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400",children:"Cancelar"})]})]})]}),e.length>0&&(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:"text",placeholder:"Buscar por d\xeda, hora o nombre...",value:n,onChange:e=>c(e.target.value),className:"w-full px-4 py-2 pl-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),(0,t.jsx)("svg",{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),n&&(0,t.jsx)("button",{onClick:()=>c(""),className:"absolute right-3 top-2.5 text-gray-400 hover:text-gray-600",children:"âœ•"})]}),n&&(0,t.jsxs)("p",{className:"mt-2 text-sm text-gray-600",children:["Mostrando ",y.length," de ",e.length," clases"]})]}),0===e.length?(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-8 text-center",children:[(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"No hay clases inicializadas."}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:"Las clases semanales fijas son:"}),(0,t.jsxs)("div",{className:"text-left max-w-md mx-auto space-y-2 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"Lunes:"})," 17:30"]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"Martes:"})," 10:00, 17:30, 19:00"]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"Jueves:"})," 10:00, 16:00, 17:30, 19:00"]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"S\xe1bado:"})," 09:30, 11:00"]})]})]}):(0,t.jsx)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"D\xeda"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Hora"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Nombre"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Acciones"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:y.map(e=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:j(e.dia)}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.hora}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.nombre}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,t.jsx)("button",{onClick:()=>b(e.id),className:"text-red-600 hover:text-red-900",children:"Eliminar"})})]},e.id))})]})})]})]})}},2712:(e,s,a)=>{"use strict";async function t(e,s){let a="Error desconocido",t=null;try{let s=e.headers.get("content-type");a=s&&s.includes("application/json")?(null==(t=await e.json())?void 0:t.error)||a:await e.text()||"HTTP ".concat(e.status,": ").concat(e.statusText)}catch(s){a="Error al procesar respuesta: ".concat(e.status," ").concat(e.statusText)}console.error("=== API ERROR ===",{route:s.route,operation:s.operation,status:e.status,statusText:e.statusText,errorDetails:t,timestamp:new Date().toISOString()});let r=a;if(t){var l,i,o;((null==(l=t.details)?void 0:l.includes("Database"))||(null==(i=t.details)?void 0:i.includes("D1"))||(null==(o=t.details)?void 0:o.includes("binding")))&&(r="Error de base de datos: "+a,"cloudflare"===t.environment&&(r+="\n\nVerifica la configuraci\xf3n de D1 en Cloudflare Pages.")),t.details&&t.details!==a&&(console.error("Error details:",t.details),"localhost"===window.location.hostname&&(r+="\n\nDetalles: ".concat(t.details))),t.debug&&console.error("Debug info:",t.debug)}return r}async function r(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0;try{let r=await fetch(e,s);if(!r.ok){let e=await t(r,a);throw Error(e)}return r}catch(e){if("TypeError"===e.name&&e.message.includes("fetch"))throw console.error("=== NETWORK ERROR ===",{route:a.route,operation:a.operation,error:e.message,timestamp:new Date().toISOString()}),Error("Error de conexi\xf3n. Verifica tu conexi\xf3n a internet o si el servidor est\xe1 disponible.");throw e}}a.d(s,{q:()=>r})},4580:(e,s,a)=>{Promise.resolve().then(a.bind(a,2321))},7969:(e,s,a)=>{"use strict";a.d(s,{A:()=>o});var t=a(5155),r=a(6874),l=a.n(r),i=a(5695);function o(){let e=(0,i.useRouter)(),s=async()=>{await fetch("/api/auth/logout",{method:"POST"}),e.push("/login"),e.refresh()};return(0,t.jsx)("nav",{className:"bg-purple-600 text-white shadow-lg",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex justify-between h-16",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-8",children:[(0,t.jsx)(l(),{href:"/",className:"text-xl font-bold",children:"Clases Bot"}),(0,t.jsx)(l(),{href:"/usuarios",className:"hover:text-purple-200 transition-colors",children:"Alumnos"}),(0,t.jsx)(l(),{href:"/clases",className:"hover:text-purple-200 transition-colors",children:"Clases"}),(0,t.jsx)(l(),{href:"/reservas",className:"hover:text-purple-200 transition-colors",children:"Reservas"})]}),(0,t.jsx)("button",{onClick:s,className:"hover:text-purple-200 transition-colors",children:"Cerrar Sesi\xf3n"})]})})})}}},e=>{e.O(0,[244,441,964,358],()=>e(e.s=4580)),_N_E=e.O()}]);